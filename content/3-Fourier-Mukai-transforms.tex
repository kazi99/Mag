\section{Fourier-Mukai transforms}
\label{Chapter: Fourier-Mukai transforms}

Let $X$ and $Y$ be smooth projective varieties over $k$ and denote the canonical projections 
\[
    p \colon X \times Y \to X \quad \text{and} \quad q \colon X \times Y \to Y.
\]

\begin{definition}
    The \emph{Fourier-Mukai transform} associated to an object $\E$ of $\derb{X \times Y}$ is defined to be the functor
    \[
        \fm{\E} \colon \derb{X} \to \derb{Y} \qquad \fm{\E} := \rderived{}{q_*}(\derivedtensor{\E}{\lderived{}{p^*}(-)}{\struct{X \times Y}}).
    \]
    The object $\E$ is called the \emph{kernel} of $\fm{\E}$.
\end{definition}

Note that as the projection $p \colon X \times Y \to X$ is flat, the pull-back functor $p^*$ need not be derived. Many examples of known functors are seen to be of Fourier-Mukai type.

\begin{example}
    \label{Identifying fm transforms}
    % In this example we notice and identity some common functors from algebraic geometry appear as Fourier-Mukai transforms. 
\begin{enumerate}[label = (\roman*)]
    \item{
    $\id{\derb{X}} \iso \fm{\struct{\Delta_X}}$. Recall that $\struct{\Delta_X}$ is defined to be the push-forward $\Delta_*\struct{X}$, of the structure sheaf of $X$ along the diagonal embedding $\Delta \colon X \to X \times X$. Then for any object $\F$ of $\derb{X}$ we compute 
    % \begin{align*}
    %     \fm{\struct{\Delta_X}} &= \rderived{}{p_*}(\derivedtensor{\struct{\Delta_X}}{\lderived{}{p^*}(E)}{\struct{X \times X}}) \\
    %     &\iso \rderived{}{p_*}(\derivedtensor{\Delta_*\struct{X}}{\lderived{}{p^*}(E)}{\struct{X \times X}}) \\
    %     &\iso \rderived{}{p_*}(\derivedtensor{\Delta_*\struct{X}}{\lderived{}{\Delta^*}(\lderived{}{p^*}(E))}{\struct{X \times X}}) \\
    % \end{align*}
    \begin{align*}
        \fm{\struct{\Delta_X}} &= p_*(\struct{\Delta_X} \otimes_{\struct{X \times X}} p^*(\F)) \\
        &= p_*(\Delta_*\struct{X} \otimes_{\struct{X \times X}} p^*(\F)) \\
        &\iso p_*(\Delta_*(\struct{X} \otimes_{\struct{X}} \Delta^*p^*(\F))) \\
        % &\iso \struct{X} \otimes E \\
        &\iso \id{\derb{X}}(\F).
    \end{align*}
    All isomorphisms are natural in $\F$, thus proving $\id{\derb{X}} \iso \fm{\struct{\Delta_X}}$.
    }
    \item{$(-)[1] \iso \fm{\struct{\Delta_X}[1]}$. A similar computation as above identifies the translation functor as a Fourier-Mukai transform with kernel $\struct{\Delta_X}[1]$.}
    \item{$\rderived{}{f_*} \iso \fm{\struct{\Gamma_f}}$. For a morphism $f \colon X \to Y$, let $\struct{\Gamma_f}$ denote the push-forward of the sheaf $\struct{X}$ along the morphism $i\colon X \to X \times Y$ induced by the identity $\id{X}\colon X \to X$ and $f\colon X \to Y$.  Then for any object $\F$ of $\derb{X}$ we have
    \begin{align*}
        \fm{\struct{\Gamma_f}} &= p_*(\struct{\Gamma_f} \otimes_{\struct{X \times Y}} q^*(\F)) \\
        &= p_*(i_*\struct{X} \otimes_{\struct{X \times X}} q^*(\F)) \\
        &\iso p_*(i_*(\struct{X} \otimes_{\struct{X}} i^*q^*(\F))) \\
        % &\iso \struct{X} \otimes E \\
        &\iso f_*\F.
    \end{align*}
    % \begin{align*}
    %     \fm{\struct{\Gamma_f}} &= \rderived{}{p_*}(\struct{\Gamma_f} \otimes_{\struct{X \times Y}} \lderived{}{q^*}(E)) \\
    %     &= \rderived{}{p_*}(i_*\struct{X} \otimes_{\struct{X \times X}} \lderived{}{q^*}(E)) \\
    %     &\iso \rderived{}{p_*}(\rderived{}{i_*}(\struct{X} \otimes_{\struct{X}} \lderived{}{i^*}\lderived{}{q^*}(E))) \\
    %     % &\iso \struct{X} \otimes E \\
    %     &\iso \rderived{}{f_*}(E).
    % \end{align*}
    Note that we have used $p \circ i = f$ and $q \circ i = \id{X}$ passing to the last line. As all the isomorphisms are natural, we have $\rderived{}{f_*} \iso \fm{\struct{\Gamma_f}}$.
    }
\end{enumerate}
\end{example}

Mukai in \cite[text]{keylist} discovered that every Fourier-Mukai transform admits left and right adjoints. 

\begin{proposition}[Mukai]
    \label{Adjoints of FM transforms}
    Let $\fm{\E} \colon \derb{X} \to \derb{Y}$ be a Fourier-Mukai transform associated to an object $E$ of $\derb{X \times Y}$. Then $\fm{\E}$ admits left and right adjoints
    \[
        \fm{\ladj{\E}} \colon \derb{Y} \to \derb{X} \quad \text{and} \quad \fm{\radj{\E}} \colon \derb{Y} \to \derb{X},
    \]
    which are evidently also Fourier-Mukai with their respective kernels
    \[
        \ladj{\E} = \E^\vee \otimes_{\struct{X \times Y}} q^*\omega_Y[\dim Y] \quad \text{and} \quad 
        \radj{\E} = \E^\vee \otimes_{\struct{X \times Y}} p^*\omega_X[\dim X].
    \]
\end{proposition}

\begin{proof}
    See \cite[\S 5, Proposition 5.9]{huybrechts2006fouriermukai}.
\end{proof}

\begin{remark}
    
\end{remark}

\begin{theorem}[\text{\cite[Theorem 2.2]{Orlov-K3}}]
    \label{Orlov's theorem}
    Let $X$ and $Y$ be smooth projective varieties over a field $k$. Suppose $F \colon \derb{X} \to \derb{Y}$ is a fully faithful functor admitting a right (and, consequently, left) adjoint functor. Then there exists up to an isomorphism a unique object $E$ of $\derb{X \times Y}$ such that $F$ and $\fm{E}$ are naturally isomorphic.
\end{theorem}

\begin{proposition}
    \label{Composition of fm is fm}
    % Let $\fm{\E^\bullet} \colon \derb{X} \to \derb{Y}$ and $\fm{\F^\bullet} \colon \derb{Y} \to \derb{Z}$ be Fourier-Mukai transforms with kernels $\E^\bullet$ and $\F^\bullet$ belonging to $\derb{X \times Y}$ and $\derb{Y \times Z}$ respectively. Then the composition $\fm{\F^\bullet} \circ \fm{\E^\bullet} \colon \derb{X} \to \derb{Z}$ is also a Fourier-Mukai transform with kernel $\mathcal R^\bullet = ...$, which is sometimes also called the \emph{convolution} of $\E^\bullet$ and $\F^\bullet$.
    Let $\fm{\E} \colon \derb{X} \to \derb{Y}$ and $\fm{\F} \colon \derb{Y} \to \derb{Z}$ be Fourier-Mukai transforms with kernels $\E$ and $\F$ belonging to $\derb{X \times Y}$ and $\derb{Y \times Z}$ respectively. Then the composition $\fm{\F} \circ \fm{\E} \colon \derb{X} \to \derb{Z}$ is also a Fourier-Mukai transform with kernel
    \[
        \G = (\pi_{XZ})_*(\pi_{XY}^*\E \otimes \pi_{YZ}^*\F),
    \]
    which is sometimes also called the \emph{convolution} of $\E^\bullet$ and $\F^\bullet$.
\end{proposition}

The following is a beautiful application of Orlov's Theorem \ref{Orlov's theorem}. It is also an important statement by itself, providing evidence for why the bounded derived category of coherent sheaves is a nicely behaved invariant for smooth projective varieties. In particular it says that $\derb{-}$ detects the dimension and triviality of the canonical bundle.  
% showing that the bounded derived categories of coherent sheaves on smooth and projective varieties over $k$ detect dimension and triviality of the canonical bundle. 
\begin{theorem}
    \label{Db detects dimension and triviality of canonical bundle}
    Suppose $X$ and $Y$ are smooth projective varieties over $k$. Assume
    \[
        \derb{X} \natiso \derb{Y}.
    \]
    Then $\dim X = \dim Y$ and if the canonical bundle $\omega_X$ of $X$ is trivial, the canonical bundle $\omega_Y$ of $Y$ is trivial as well.
\end{theorem}

\begin{proof}
    By Orlov's Theorem \ref{Orlov's theorem} the equivalence $\derb{X} \natiso \derb{Y}$ is witnessed by a Fourier-Mukai transform $\fm{E}$ with the kernel $E$ belonging to $\derb{X \times Y}$. Since $\fm{E}$ is an equivalence its left and right adjoints agree. As they are both given by Fourier-Mukai transforms their respective kernels $\ladj{E}$ and $\radj{E}$, introduced in Proposition \ref{Adjoints of FM transforms}, must be isomorphic in $\derb{X \times Y}$. Writing this out we see that
    \[
        E^\vee \iso E^\vee \otimes (q^*\omega_X \otimes p^*\omega_Y)[\dim Y - \dim X].
    \]
    As tensoring by a line bundle, namely $q^*\omega_X \otimes p^*\omega_Y$ is exact, both tensor products are underived, but more importantly, the cohomology of complexes $E^\vee$ and ${E^\vee \otimes (q^*\omega_X \otimes p^*\omega_Y)}$ agree in all degrees. Since $E$ is a bounded complex of coherent sheaves, its derived dual $E^\vee = \rderived{}{\localhom[X \times Y]^\bullet(E, \struct{X \times Y})}$ is bounded as well. Then comparing cohomology intermediately\footnote{As $\fm{E}$ is an equivalence, the kernel $E$ cannot be isomorphic to the zero object in $\derb{X \times Y}$, implying that $E^\vee$ has non-trivial cohomology at least in some degrees.} gives 
    \[
        \dim X = \dim Y.
    \]
    
    For the second part, the assumption $\omega_X \iso \struct{X}$, simplifies the Serre functor $S_X$ of $\derb{X}$ to 
    \[
        S_X \colon \derb{X} \to \derb{X} \qquad S_X \natiso (-)[n], 
    \]
    where $n$ denotes the dimensions of both $X$ and $Y$. Since equivalences of triangulated categories are known to commute with Serre functors by Proposition \ref{Serre functors commute with equivalences}, we deduce from $\fm{E} \circ S_X \natiso S_Y \circ \fm{E}$ that the Serre functor $S_Y$ of $\derb{Y}$ also simplifies to $(-)[n]$. By Definition \ref{Serre functor on Db(X)} this may be expressed as
    \[
        (-)[n] \natiso S_Y = (-) \otimes_{\struct{Y}} \omega_Y[n].
    \]
    Plugging in the structure sheaf $\struct{Y}$, we see that $\omega_Y \iso \struct{Y}$ holds in $\coherent{Y}$. The last assertion 
    % about $\coherent{Y}$ 
    follows from fully faithfulness of the inclusion $\coherent{Y} \to \derb{Y}$ according to Proposition \ref{A -> D(A) fully faithful}. 
\end{proof}

\subsection{...on $K$-groups}
\label{Subsection: FM transform on K-theory}

We introduce the $K$-theoretic Fourier-Mukai transforms as a passageway between categorical and cohomological Fourier-Mukai transforms. In particular we will utilize the Grothendieck-Riemann-Roch theorem, which will later on help us relate the two in Section \ref{Subsection: FM transform on cohomology}.



\subsection{...on rational cohomology}
\label{Subsection: FM transform on cohomology}

A Fourier-Mukai type map exists also between the rational cohomology modules of $X$ and $Y$ associated to any cohomology class $\alpha \in \cohom{*}{X \times Y}{\Q}$. In order to introduce it we first need to define the correct analog of the ``push-forward map'' on cohomology. We are again assuming that $X$ and $Y$ are smooth and projective varieties over $\C$ and we identify them with their respective complex analytic spaces, which are in this case compact connected complex manifolds. As such they are orientable as real manifolds, admitting Poincaré duality to relate their homology and cohomology. Let $n$ denote the \emph{real} dimension of $X$ and let $[X] \in H_n(X, \Q)$ denote the (rational) fundamental class of $X$. By Poincaré duality \cite[\S VI, Theorem 8.3]{Bredon1993} the homomorphism
\[
    [X] \smallfrown - \colon \cohom{k}{X}{\Q} \to H_{n-k}(X, \Q)
\]
is an isomorphism and we denote its inverse with $D_X \colon H_{n-k}(X, \Q) \to \cohom{k}{X}{\Q}$.

\begin{definition}
    Let $f \colon X \to Y$ be a continuous map between two compact connected complex manifolds. Let $n$ denote the dimension of $X$ and $m$ the dimension of $Y$.
    %  of real dimension $n$ and $m$ respectively.
    The \emph{Gysin map}\footnote{This map is sometimes also called the \emph{umkehr map}. The German word ``umkehr'' points out the fact that the map goes in the opposite direction of the standard pull-back.}$f_! \colon \cohom{k}{X}{\Q} \to \cohom{m-n+k}{Y}{\Q}$ is defined to be the composition
    \[
        f_! \colon \quad \cohom{k}{X}{\Q} \xrightarrow{[X] \smallfrown -} H_{n-k}(X, \Q) \xrightarrow{\ f_* \ } H_{n-k}(Y, \Q) \xrightarrow{D_Y} \cohom{m-n+k}{Y}{\Q}.
    \]
\end{definition}

\begin{remark}
    In other words $f_!$ is precisely the map, which fits into the commutative diagram below
    \[\begin{tikzcd}
        % https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXGJ1bGxldCJdLFsyLDAsIlxcYnVsbGV0Il0sWzAsMiwiXFxidWxsZXQiXSxbMiwyLCJcXGJ1bGxldCJdLFswLDEsIltYXSBcXHNtYWxsZnJvd24gLSJdLFsyLDMsIltZXSBcXHNtYWxsZnJvd24gLSJdLFsxLDMsImZfKiJdLFswLDIsImZfISIsMl1d
        \cohom{k}{X}{\Q} && H_{n-k}(X, \Q) \\
        \\
        \cohom{m-n+k}{X}{\Q} && H_{n-k}(X, \Q).
        \arrow["{[X] \smallfrown -}", from=1-1, to=1-3]
        \arrow["{f_!}"', from=1-1, to=3-1]
        \arrow["{f_*}", from=1-3, to=3-3]
        \arrow["{[Y] \smallfrown -}", from=3-1, to=3-3]
    \end{tikzcd}\]
\end{remark}

\begin{remark}
    For a topological space $X$ we will distinguish between the collection of all cohomology groups, considered concisely as a graded object $\cohom{\bullet}{X}{\Z} = \bigoplus_{i\in \Z} \cohom{i}{X}{\Z}$, and its (graded) cohomology ring, which we will denote by $\cohom{*}{X}{\Z}$.
\end{remark}

\begin{proposition}[Cohomological projection formula]
    \label{cohomological projection formula}
    Let $f \colon X \to Y$ be a continuous map between closed orientable manifolds $X$ and $Y$. Then for all $\alpha \in \cohom{*}{X}{\Z}$ and $\beta \in \cohom{*}{Y}{\Z}$
    \[
        f_!(\alpha) \smallsmile \beta = f_!(\alpha \smallsmile f^*\beta).
    \]
\end{proposition}

\begin{remark}
    In the proof of the above proposition we use the following formulas, which are easily seen to follow by unwrapping the definitions of operations $\smallsmile$ and $\smallfrown$ on singular cohomology and homology. They may also be found in \cite[\S VI, Theorem 5.2]{Bredon1993}.
    \begin{enumerate}[label = (\roman*)]
        \item{Let $\eta \in \cohom{k}{X}{\Z}$, $\theta \in \cohom{\ell}{X}{\Z}$ and $\sigma \in H_{k+\ell+m}(X, \Z)$, then 
        \[
            (\sigma \smallfrown \eta) \smallfrown \theta = 
            \sigma \smallfrown (\eta \smallsmile \theta)
        \]
        holds in $H_m(X, \Z)$.}
        \item{Let $\sigma \in H_{k + \ell}(X, \Z)$ and $\eta \in \cohom{k}{Y}{\Z}$ then 
        \[
            f_*(\sigma \smallfrown f^*\eta) = f_*\sigma \smallfrown \eta
        \]
        holds in $H_\ell(Y, \Z)$.
        }
    \end{enumerate}
\end{remark}

\begin{proof}[Proof of Proposition \ref{cohomological projection formula}]
    % Let $n$ and $m$ denote the real dimensions of $X$ and $Y$ respectively.
    We compute that
    \begin{align*}
        f_!(\alpha \smallsmile f^*\beta) &=
        D_Y(f_*([X] \smallfrown (\alpha \smallsmile f^*\beta))) \\
        &= D_Y(f_*(([X] \smallfrown \alpha) \smallfrown f^*\beta)) \\
        &= D_Y(f_*([X] \smallfrown \alpha) \smallfrown \beta) \\
        &= D_Y(([Y] \smallfrown f_!(\alpha)) \smallfrown \beta) \\
        &= D_Y([Y] \smallfrown (f_!(\alpha) \smallsmile \beta)) \\
        &= f_!(\alpha) \smallsmile \beta. \qedhere
    \end{align*}
\end{proof}

As before let $p \colon X \times Y \to X$ and $q \colon X \times Y \to Y$ denote the canonical projections, now in the category of complex manifolds. 

\begin{definition}
    The \emph{cohomological Fourier-Mukai transform} associated to a cohomology class $\alpha \in \cohom{\bullet}{X \times Y}{\Q}$ is defined to be the homomorphism
    \[
        f^\alpha \colon \cohom{\bullet}{X}{\Q} \longrightarrow \cohom{\bullet}{Y}{\Q} \qquad \beta \longmapsto q_!(\alpha \smallsmile p^*\beta).
    \]
\end{definition}

We would now like to relate this cohomological Fourier-Mukai transform back to the K-theoretic and the categorical one. This will be achieved by applying the famous Grothendieck-Riemann-Roch theorem \ref{Grothendieck-Riemann-Roch}, for which we first need to introduce the Chern character and the Todd class. 

\begin{proposition}
    \label{Composition of cohomological fm is fm}
    Let $\fmcoh{\E^\bullet} \colon H^\bullet(X, \Q) \to H^\bullet(Y, \Q)$ and $\fmcoh{\F^\bullet} \colon H^\bullet(Y, \Q) \to H^\bullet(Z, \Q)$ be cohomological Fourier-Mukai transforms for $\E^\bullet$ and $\F^\bullet$ belonging to $\derb{X \times Y}$ and $\derb{Y \times Z}$ respectively. Then the composition $\fmcoh{\F^\bullet} \circ \fmcoh{\E^\bullet}$ is also a cohomological Fourier-Mukai transform with kernel $\mathcal R^\bullet$ of Proposition \ref{}
\end{proposition}

\begin{theorem}[Grothendieck-Riemann-Roch]
    \label{Grothendieck-Riemann-Roch}
    Let
\end{theorem}

\begin{remark}
    What's the deal with Chow groups $A_\Q(X)$    
\end{remark}

\begin{corollary}[Hirzebruch-Riemann-Roch]
    \label{Hirzebruch-Riemann-Roch}
    \[
        \chi(X, \E) = \int_X \ch{\E}\tdclass{X}.
    \]
\end{corollary}

\begin{remark}
    The integral on the right hand side we will take to be $\int_X \ch{\E}\tdclass{X} = \pairing{\ch{\E}\tdclass{X}}{[X]}$. 
    % In other words to compute the right side we only calculate the top degree contributions of the product $\ch{\E}\td{X}$
    Letting $n$ denote the real dimension of $X$, computing the integral amounts to calculating the $n$-th degree contributions of the product $\ch{\E}\td{X}$ and evaluating them into a rational number through the isomorphism $\cohom{n}{X}{\Q} \iso \Q$, given by the choice of a fundamental class $[X]$.
\end{remark}

\begin{proof}
    from GRR.
\end{proof}

\begin{proposition}
    \label{Hodge lattice, fm transform interaction}
    Then for every pair of integers $(p,q)$
    \begin{equation}
        \label{eq: Hodge lattice, fm transform}
        \fmcoh{E}_\C\left(H^{p,q}(X)\right) \subseteq \bigoplus_{s - t = p - q} H^{s,t}(Y).
    \end{equation}
\end{proposition}