\section{Spectral sequences and how to use them}
\label{Appendix A}

In this chapter we will first define cohomological spectral sequences and then discuss their meaning through applications related with derived categories.

At first, when encountering spectral sequences, one might think of them as just  bookkeeping devices encoding a tremendous amount of data, but we will soon see how elegantly one can infer certain properties related to derived categorical claims exploiting the fact that they can naturally be encoded with spectral sequences.
% from a spectral sequence associated to a given problem  that we can encode a problem in terms of such a sequence. 
% just by considering their form for example.
One of the most important spectral sequences, which is also very general within our scope of inspection, will be the Grothendieck spectral sequence relating the higher derived functors of two composable functors with the higher derived functors of their composition. Later on we will see that many useful and well-known spectral sequences occur as special cases of the Grothendieck spectral sequence. What follows was gathered mostly from \cite[\S 2.2.1]{huybrechts2006fouriermukai} and \cite[\S III.7]{gelfand2002methods}.

% For the time being we fix an abelian category $\mathcal A$ and start off with a definition.

\begin{definition}
    A \emph{(cohomological) spectral sequence} in an abelian category $\mathcal A$ consists of the following data on which we further impose two convergence conditions.
\begin{itemize}
    \item \emph{Sequence of pages.} 
    % A finite page at step $r \in \N$ is a bi-graded object $E^{\bullet, \bullet}_r$ together with differentials of bi-degree $(r, 1-r)$ \ie morphisms
    % \[
    %     d^{p,q}_r : E^{p,q}_r \to E^{p + r, q - r + 1}_r
    % \] 
    % satisfying
    % \[
    %     d^{p + r, q - r + 1}_r \circ d^{p,q}_r = 0,
    % \]
    % for each $p, q \in \Z$.
    A sequence of bi-graded objects $(E^{\bullet, \bullet}_r)_{r \in \N}$ equipped with differentials of bi-degree $(r, 1-r)$. The $r$-th term of this sequence is called the $r$-th \emph{page} and it consists of a lattice of objects $E^{p,q}_r$ of $\mathcal A$, for $p, q \in \Z$, and differentials
    \[
        d^{p,q}_r : E^{p,q}_r \to E^{p + r, q - r + 1}_r,
    \] 
    satisfying
    \[
        d^{p + r, q - r + 1}_r \circ d^{p,q}_r = 0,
    \]
    for each $p, q \in \Z$.
    \item \emph{Isomorphisms.} A collection of isomorphisms
    \[
        \alpha^{p,q}_r : H^{p,q}(E_r) \xrightarrow{\sim} E^{p,q}_{r + 1},
    \]
    for all $p, q \in \Z$ and $r \in \N$, where 
    \[
        H^{p,q}(E_r) := \ker(d^{p,q}_r)/\im(d^{p-r, q + r - 1}_r),
    \]
    which allow us to turn the pages.
    \item \emph{Transfinite page.} A bi-graded object $E^{\bullet, \bullet}_\infty$. 
    % Without any differentials.
    \item \emph{Goal of computation.} A sequence of objects $(E^n)_{n \in \Z}$ of the category $\mathcal A$.
\end{itemize}
The above collection of data also has to satisfy the following two convergence conditions.
\begin{enumerate}[label = (\alph*)]
    \item For each pair $(p,q)$, there exists $r_0 \geq 0$, such that for all $r \geq r_0$ we have
    \[
        d^{p,q}_r = 0 \quad \text{and} \quad d^{p + r, q - r + 1}_r = 0
    \]
    and the isomorphism $\alpha^{p,q}_r$ can be taken to be the identity. We then say that the $(p,q)$-term \emph{stabilizes} after page $r_0$ and we denote $E^{p,q}_{r_0}$ (along with all the subsequent $E^{p,q}_{r}$ for $r \geq r_0$) by $E^{p,q}_\infty$.
    \item For each $n \in \Z$ there is a \emph{regular}\footnote{In our case the filtration $(F^p E^n)_{p \in \Z}$ is \emph{regular}, whenever $\bigcap_p F^p E^n = \lim_p F^p E^n = 0$ and $\bigcup_p F^p E^n = \colim_p F^p E^n = E^n$.} decreasing filtration of $E^n$
    \begin{equation}
        \label{eq: regular filtration}
        E^n \supseteq \dots \supseteq F^p E^n \supseteq F^{p + 1}E^n \supseteq \dots \supseteq 0
    \end{equation}
    and isomorphisms
    \[
        \beta^{p,q} : E^{p,q}_\infty \xrightarrow{\sim} F^p E^{p + q}/F^{p + 1}E^{p + q}
    \]
    for all $p, q \in \Z$.
\end{enumerate}

In this case we also denote the existence of such a spectral sequence by 
\[
    E^{p,q}_r \implies E^{p+q}.
\]
\end{definition}

\begin{remark}
    A few words are in order to justify us naming the sequence $(E^n)_{n \in \Z}$ our \emph{goal of computation}. Usually one is given a starting page or a small number of them and the first goal is to identify the transfinite page -- we are referring to convergence condition (a). Often one is able to infer the differentials degenerate after a number of turns of the pages from context or by observing the shape of the spectral sequence. For example \emph{first quadrant spectral sequences}, \ie the ones with non-trivial $E^{p,q}_r$ only for $(p,q)$ lying in the first quadrant, always satisfy condition (a).

    The second part of the computation is concerned with relating objects from the transfinite page $E^{\bullet, \bullet}_\infty$ with objects $E^n$. This is captured in the convergence condition (b), from which we can clearly observe that the intermediate quotients of the filtration $(F^p E^n)_{p \in \Z}$, for a fixed term $E^n$, lie on the anti-diagonal
    % (with direction vector $(1,-1)$)
    of the transfinite page passing through \eg $E^{n, 0}_\infty$. Explicitly these are terms $\dots, E^{n-1,1}_\infty, E^{n,0}_\infty, E^{n+1,-1}_\infty, \dots$
    
    In condition (b) the existence of isomorphisms $\beta^{p,q}$ can also be restated by saying that $E^{p,q}_\infty$ fits into a short exact sequence
    \begin{equation}
        \label{eq: SES of filtration}
        0 \to F^{p + 1} E^n \to F^p E^n \to E^{p,q}_\infty \to 0.
    \end{equation}
    This observation becomes very useful when considering properties of objects of the category $\mathcal A$ which are closed under extensions, especially when the filtration of $E^n$ is finite.

    % In that case one can inductively reason about such a property of $E^n$ provided the filtration of $E^n$ is finite.
 \end{remark}

\begin{lemma}
    \label{finite filtration}
    Let $a \leq b$ be integers and consider a regular decreasing filtration
    \begin{equation}
        \label{eq: filtration}
        F \supseteq \dots F^{p-1} \supseteq F^p \supseteq F^{p + 1} \supseteq \dots \supseteq 0
    \end{equation}
    of an object $F$. Assume that the quotients $F^p/F^{p+1}$ vanish for $p \notin [a,b]$, then $F^{p} \iso F$ for all $p \leq a$ and $F^{p} \iso 0$ for all $p \geq b$, so \eqref{eq: filtration} is a finite filtration of $F$. In particular, when $a = b$, we have $F \iso 0$.
\end{lemma}

\begin{proof}
    Since the quotients $F^p/F^{p+1}$ vanish for $p \notin [a,b]$, all the inclusions $F^{p+1} \subseteq F^p$ turn into isomorphisms. Then by regularity it follows that $F = \colim_p F^p \iso \colim_{p \leq a} F^p = F^{a}$ and similarly $0 \iso \lim_p F^p \iso \lim_{p \geq b} F^p =  F^b$.
\end{proof}

% Next we mention two ways of naturally obtaining a spectral sequence, the first one arises from a filtered chain complex. A filtration of a chain complex $K^\bullet \in \Ob(\com(\mathcal A))$ is a decreasing sequence of chain complexes 
% \[
%  K^\bullet \supseteq \dots \supseteq F^p K^\bullet \supseteq F^{p+1}K^\bullet \supseteq \dots \supseteq 0
% \]
% respecting the differential of $K^\bullet$ \ie $d(F^p K^n) \subseteq F^p K^{n+1}$. Using only this piece of information one can 

In his famous TÃ´hoku paper \cite{grothendieck57} Grothendieck devised the following spectral sequence relating higher derived functors of a composition of two left exact functors with the composition of their higher derived functors. For a proof see either the original \cite[\S 2.4]{grothendieck57} or \cite[\S III.7, Theorem 7]{gelfand2002methods}.
%  or the original
% \cite[\S 2, Proposition 2.66]{huybrechts2006fouriermukai} (merely a sketch)
% \cite[\S 2.4]{grothendieck57}.

\begin{theorem}
    \label{Grothendieck spectral sequence}
    \emph{\cite{grothendieck57}}
    Let $F\colon \A \to \B$ and $G\colon \B \to \mathcal C$ be left exact functors between abelian categories. Let $\I_F$ be an $F$-adapted class in $\A$, $\I_G$ a $G$-adapted class of objects in $\B$ and suppose every object of $\I_F$ is sent to a $G$-acyclic object by the functor $F$. Then for every $A^\bullet$ in $\kplus{\A}$ there exists a spectral sequence
    \begin{equation}
        \label{eq: Grothendieck spectral sequence}
        E^{p,q}_2 = \rderived{p}{G}(\rderived{q}{F}(A^\bullet)) \implies \rderived{p+q}{(G \circ F)}(A^\bullet) = E^{p+q}.
    \end{equation} 
\end{theorem}

\begin{remark}
    Taking the functor $F$ to be the identity in Theorem \ref{Grothendieck spectral sequence} we obtain as a consequence that for any left exact functor $F \colon \A \to \B$, admitting a right derived functor $\rderived{}{F}\colon \derplus{\A} \to \derplus{\B}$ there is a spectral sequence 
    \begin{equation}
        \label{eq: special case of Grothendieck spectral sequence}
        E^{p,q}_2 = \rderived{p}{F}(H^q(A^\bullet)) \implies \rderived{p+q}{F}(A^\bullet) = E^{p+q},
    \end{equation}
    for every $A^\bullet$ of $\kplus{\A}$.
\end{remark}

\begin{definition}
    Let $\B$ be an abelian category and $\mathcal C$ its \emph{full abelian subcategory}, meaning that $\mathcal C$ is abelian, a full subcategory of $\B$ and the inclusion functor $\mathcal C \hookrightarrow \B$ is exact. Then $\mathcal C$ is called \emph{thick} if every extension in $\B$ of objects in $\mathcal C$ is again in $\mathcal C$. In other words, assuming 
    \[
            0 \to B_0 \to B_1 \to B_2 \to 0
    \]
    is a short exact sequence in $\B$, if $B_0$ and $B_2$ belong to $\mathcal C$, then so does $B_1$.
    
    % then the condition
    % for any short exact sequence
    % \[
    %         0 \to B_0 \to B_1 \to B_2 \to 0
    % \]
    % in $\B$, if $B_0$ and $B_2$ belong to $\mathcal C$, then so does $B_1$. 
    % Let $\mathcal C$ be a full abelian subcategory of an abelian 

    % Let $\B$ be an abelian category and $\mathcal C$ a full additive subcategory of $\B$.
    % \begin{enumerate}[label = (\roman*)]
    %     \item{ 
    %     The subcategory $\mathcal C \subseteq \B$ is \emph{closed under extensions}, if for any objects $B_0$, $B_1$, $B_2$ of $\B$, for which there is a short exact sequence
    %     \[
    %         0 \to B_0 \to B_1 \to B_2 \to 0,
    %     \]
    %     the condition that $B_0$ and $B_1$ belong to $\mathcal C$, implies that $B_2$ belongs to $\mathcal C$.
    %     }
    %     \item{
    %     The subcategory $\mathcal C \subseteq \B$ is \emph{thick}, if it contains kernels and cokernels of all its morphisms and is closed under extensions.
    %     }
    %     \end{enumerate}
    %  meaning that for any objects $C_0$, $C_1$, $C_2$ of $\B$ for which there is a short exact sequence
    % \[
    %     0 \to C_0 \to C_1 \to C_2 \to 0,
    % \]
    % if $C_0$ and $C_1$ belong to $\mathcal C$, then so does $C_2$.
    % Let $\mathcal C$ be an abelian subcategory of an abelian category $\B$. 
\end{definition}

\begin{example}
    The subcategory of finitely generated abelian groups forms a thick subcategory of the category of abelian groups $\Ab$.
\end{example}

\begin{proposition}
    \label{Spectral sequences for derived cats}
    \emph{\cite[\S 2, Corollary 2.68]{huybrechts2006fouriermukai}}
    Let $F \colon \A \to \B$ be a left exact functor admitting a right derived functor $\rderived{}{F}\colon \derplus{\A} \to \derplus{\B}$. 
    \begin{enumerate}[label = (\roman*)]
        \item{Suppose that for every object $A$ of $\A$ the objects $\rderived{i}{F}(A)$ are non-trivial only for finitely many $i \in \Z$. Then $\rderived{}{F}(A^\bullet)$ belongs to $\derb{\B}$ for any bounded complex $A^\bullet$ of $\derb{\A}$, consequently inducing a right derived functor on the level of bounded derived categories
        \[
            \rderived{}{F} \colon \derb{\A} \to \derb{\B}.
        \]} \label{Bounded on objects implies bounded on complexes}
        \item{Let $\mathcal C \subset \B$ be a thick subcategory of $\B$ and assume that for every $A^\bullet$ of $\derplus{\A}$, $\rderived{i}{F}(A)$ belong to $\mathcal C$ for all $A$ of $\A$ and $i \in \Z$. Moreover assume there exists $m \in \N$, such that $\rderived{i}{F}(A) = 0$, for all $A$ of $\A$ and $i > m$. Then $\rderived{}{F}(A^\bullet)$ belongs to $\mathsf{D}^+_\mathcal{C}(\B)$ for any $A^\bullet$ in $\derplus{\A}$, therefore inducing the functor
        \[
            \rderived{}{F}\colon \derplus{\A} \to \mathsf{D}^+_\mathcal{C}(\B).
        \]
        } \label{Cohomology in a thick subcategory}
    \end{enumerate}
\end{proposition}

\begin{proof}
    For (i) consider $A^\bullet$ in $\derb{\A}$. We will show that $\rderived{i}{F}(A^\bullet)$ is non-trivial only for finitely many $i \in \Z$. To do so, we will use spectral sequence \eqref{eq: special case of Grothendieck spectral sequence}. As the $q$-th cohomology $H^q(A^\bullet)$ is an object of $\A$, the complex $\rderived{}{F}(H^q(A^\bullet))$ is bounded by assumption and thus $\rderived{p}{F}(H^q(A^\bullet))$ is non-trivial only for finitely many $p \in \Z$. Since $A^\bullet$ is also a bounded complex we see that all the non-trivial objects of page $E_2$ may be collected inside of a large enough square, 
    % say $D = [x_0,x_1] \times [y_0,y_1]$ for integers $x_0 < x_1$ and $y_0 < y_1$. 
    say $D = [-a, a]^2$ for a positive integer $a \in \Z$.
    In other words $E^{p,q}_2 \iso 0$ for $(p,q) \notin D$, implying that also $E^{p,q}_\infty \iso 0$ for $(p,q) \notin D$. This means that all the intermediate quotients of the filtration of $E^n$, \ie the terms $E^{p,q}_\infty$, with $p + q = n$, are trivial, provided $\abs{n} > 2a$. By regularity of the filtrations, we deduce that $\rderived{n}{F}(A^\bullet) = E^n \iso 0$ for $\abs{n} > 2a$, implying that $\rderived{}{F}(A^\bullet)$ belongs to $\derb{\B}$.
    
    For (ii) we will apply the same idea and use the spectral sequence \eqref{eq: special case of Grothendieck spectral sequence} to show that $\rderived{i}{F}(A^\bullet)$ belong to $\mathcal C$ for all $i \in \Z$. This time we see that $\rderived{p}{F}(H^q(A^\bullet)) = E^{p,q}_2 \iso 0$ for $p \notin [0,m]$, thus the same goes for $E^{p,q}_\infty$. Since every anti-diagonal (line with slope $-1$) going through a point with integral coordinates passes through only $m+1$ other points with integral components lying in the infinite strip $[0,m] \times \Z$, all the objects $E^n$ have finite regular filtrations by Lemma \ref{finite filtration}. They look like this
    \begin{equation}
        \label{eq: finite filtration}
        E^n = F^0E^n \supseteq_{E^{0,n}_\infty} F^1E^n \supseteq_{E^{1, n-1}_\infty} F^2E^n \supseteq \cdots \supseteq F^mE^n \supseteq_{E^{m, n-1}_\infty} F^{m+1}E^n = 0.
    \end{equation}
    The intermediate quotients, inscribed in the subscript of $\supseteq$\footnote{
        % The inscription in the index of $\supseteq$ is meant to denote the intermediate quotients between two subsequent terms of the filtration. 
        For example $F^0E^n \supseteq_{E^{0,n}_\infty} F^1E^n$ is supposed to mean that the quotient $F^0E^n / F^1E^n$ is isomorphic to $E^{0,n}_\infty$.}
    , of said filtration are precisely those $E^{p,q}_\infty$, with $p+q = n$ and $(p,q) \in [0,m] \times \Z$. Since $\mathcal C$ is thick, in particular closed under kernels and quotients, and all the objects of page $E_2$ belong to $\mathcal C$ by assumption, then all the objects from all the subsequent pages, including the transfinite one $E_\infty$, also belong to $\mathcal C$. 
    %  as the latter category is thick and in particular closed under kernels and quotients. 
    Inductively, using short exact sequences \eqref{eq: SES of filtration} and thickness of $\mathcal C$, we then see, that all the terms of the finite filtration \eqref{eq: finite filtration} belong to $\mathcal C$, including $E^n = \rderived{n}{F}(A^\bullet)$.
    %  is built up as a series of extensions problems, consisting of objects from the thick category $\mathcal C$, making $E^n$ belong to $\mathcal C$ as well. 
\end{proof}

\begin{proposition}
    Let $\A$ be an abelian category with enough injectives. Suppose $A^\bullet$ belongs to $\kminus{\A}$ and $B^\bullet$ belongs to $\kplus{\A}$. Then there exist spectral sequences 
        \begin{equation}
        \label{eq: Spectral sequence Ext 2}
        E^{p,q}_2 = \Ext^p_\A(A^\bullet, H^q(B^\bullet)) \implies \Ext^{p+q}_\A(A^\bullet, B^\bullet) = E^{p+q}
    \end{equation}
    and
    \begin{equation}
        \label{eq: Spectral sequence Ext 1}
        E^{p,q}_2 = \Ext^p_\A(H^{-q}(A^\bullet), B^\bullet) \implies \Ext^{p+q}_\A(A^\bullet, B^\bullet) = E^{p+q}.
    \end{equation}
\end{proposition}

\begin{proof}
    See \cite[\S 2, Example 2.70]{huybrechts2006fouriermukai}.
\end{proof}

\begin{remark}
    Using Proposition \ref{Homs in derived category}, and taking $A^\bullet$ and $B^\bullet$ to be bounded complexes of $\derb{\A}$ the spectral sequences \eqref{eq: Spectral sequence Ext 2} and \eqref{eq: Spectral sequence Ext 1} specialize to 
    \begin{align}
        E^{p,q}_2 = \Hom_{\derb{\A}}(A^\bullet, H^q(B^\bullet)[p]) &\Rightarrow \Hom_{\derb{\A}}(A^\bullet, B^\bullet[p+q]) = E^{p+q}, \\
        E^{p,q}_2 = \Hom_{\derb{\A}}(H^{-q}(A^\bullet), B^\bullet[p]) &\Rightarrow \Hom_{\derb{\A}}(A^\bullet, B^\bullet[p+q]) = E^{p+q}. 
        \label{eq: Spectral sequence derived hom 1}
    \end{align}
\end{remark}